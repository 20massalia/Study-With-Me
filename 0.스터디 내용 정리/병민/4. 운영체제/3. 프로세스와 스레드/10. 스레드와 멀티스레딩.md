# 스레드와 멀티스레딩

## 1. 스레드(Thread)란?
스레드는 프로세스 내에서 실행 흐름의 최소 단위입니다. 하나의 프로세스는 여러 개의 스레드를 가질 수 있으며, 각 스레드는 코드, 데이터, 힙 영역을 공유하고 스택 영역만 독립적으로 할당받습니다.

- **프로세스**: 자원(메모리, 파일 등)을 할당받아 실행되는 프로그램의 인스턴스
- **스레드**: 프로세스 내에서 실행 흐름을 담당하는 단위. 경량 프로세스(Lightweight Process)라고도 불림

### 스레드의 구조
- **공유 영역**: 코드, 데이터, 힙
- **독립 영역**: 스택(함수 호출, 지역 변수, 리턴 주소 등)

- ![스레드](https://gmlwjd9405.github.io/images/os-process-and-thread/process.png)

### 싱글 스레드의 장점
- 자원 동기화에 대해 신경 쓰지 않아도됨
- 컨텍스트 스위칭을 요구하지 않음

### 싱글 스레드의 단점
- 여러개의 CPU 자원을 활용하지 못함
- 동시에 여러 작업을 해야할 경우 느림

## 2. 멀티스레딩(Multithreading)
멀티스레딩은 하나의 프로세스 내에서 여러 스레드가 동시에 실행되는 구조입니다. 병렬 처리, 자원 효율성, 응답성 향상에 유리합니다.

![멀티스레딩](https://goodgid.github.io/assets/img/os/what_is_multi_thread_1.png)

![멀티스레딩](https://velog.velcdn.com/images%2Feunjin%2Fpost%2Fc63d6950-7ae7-439a-9ee8-d6f145d6808a%2FScreen%20Shot%202021-01-17%20at%204.18.53%20PM.png)

### 멀티스레딩의 장점
- 자원 공유로 메모리 사용 효율적
- 빠른 컨텍스트 스위칭(스택만 교체)
- 동시성/병렬성 구현 용이
- I/O 대기 중에도 다른 작업 수행 가능

### 멀티스레딩의 단점
- 동기화 문제(데드락, 레이스 컨디션)
- 안정성 저하(한 스레드 오류가 전체 프로세스에 영향)
- 과도한 스레드 생성 시 오버헤드 증가

## 3. 동기화와 임계영역
멀티스레딩 환경에서는 여러 스레드가 동시에 공유 자원에 접근할 수 있어 데이터 불일치, 충돌이 발생할 수 있습니다.

- **임계영역(Critical Section)**: 여러 스레드가 동시에 접근하면 안 되는 코드 영역
- **동기화(Synchronization)**: 임계영역 보호를 위한 기법(뮤텍스, 세마포어, 모니터 등)
- **데드락(Deadlock)**: 두 개 이상의 스레드가 서로 자원을 기다리며 무한 대기
- **레이스 컨디션(Race Condition)**: 여러 스레드가 동시에 자원에 접근해 결과가 예측 불가

## 4. OS와 하드웨어 관점의 스레드
- **커널 스레드(Kernel Thread)**: OS 커널이 직접 관리. 문맥 전환 비용 높음
- **유저 스레드(User Thread)**: 사용자 레벨에서 관리. 커널에선 하나의 프로세스로 인식
- **1:1 모델**: 유저 스레드 1개당 커널 스레드 1개
- **N:1 모델**: 여러 유저 스레드가 하나의 커널 스레드에 매핑
- **N:M 모델**: 여러 유저 스레드가 여러 커널 스레드에 매핑

## 6. 멀티스레딩과 병렬성
- **동시성(Concurrency)**: 여러 작업이 논리적으로 동시에 진행
- **병렬성(Parallelism)**: 실제로 여러 CPU 코어에서 동시에 실행
- CPU 코어 수보다 많은 스레드 생성 시 컨텍스트 스위칭 오버헤드 발생

## 7. 면접에서 자주 나올만한 질문들

1. 스레드와 프로세스의 차이점은?
2. 멀티스레딩의 장단점은?
3. 임계영역과 동기화 기법(뮤텍스, 세마포어 등)을 설명해보세요.
4. 데드락과 레이스 컨디션이란?
5. 커널 스레드와 유저 스레드의 차이점은?
6. 멀티스레딩이 항상 성능을 높여주는가?
7. 자바에서 스레드 안전성을 확보하는 방법은?

## Reference
https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html
https://inpa.tistory.com/entry/%F0%9F%91%A9%E2%80%8D%F0%9F%92%BB-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%E2%9A%94%EF%B8%8F-%EC%93%B0%EB%A0%88%EB%93%9C-%EC%B0%A8%EC%9D%B4
https://hackmd.io/@KangMoo/Bk5Z1c_en

