# HTTP

> HyperText Transfer Protocol 의 약자로 웹에서 클라이언트와 서버 간에 데이터를 주고받는 프로토콜 <br>
기본적으로 Stateless하며, 텍스트 기반과 요청-응답 구조로 이루어짐


## HTTP/1.0

* 하나의 요청에 하나의 TCP 연결 즉, 3-way와 4-way를 진행하는 방식
* 다만, 요청마다 새로운 연결을 맺기 때문에 지연이 발생하는 단점 (RTT 증가)
* Host 헤더가 없어 가상 호스팅이 불가능

하나의 IP 마다 하나의 도메인 할당

## HTTP/1.1

* HTTP/1.0에서 매번 요청마다 새로운 연결을 맺는 방법 대신
* 하나의 TCP 연결만 진행한 후 여러 요청을 진행하는 Keep-Alive를 도입.

* Pipelining을 통해 응답을 기다리지 않고 순차적인 여러 요청을 연속적으로 보내 그 순서에 맞춰 응답을 받는 방식으로 지연 시간 줄임

* Host 헤더의 추가를 통해 하나의 IP에 여러 개의 도메인을 운영할 수 있음

* 단, **HOL Blocking 문제** 발생

    * 어떤 요청에 병목이 생겨 전체 latency가 증가하는 것
    * 만약 패킷이 제대로 전달되지 않았을 경우 재전송 필요 -> 요청을 받은 순서대로 응답을 해야하므로, 앞선 요청에 의해 뒤에 요청이 지연

* **무거운 Header**
    * 중복된 헤더와 cookie 정보 역시 매 요청마다 헤더에 포함
    * 불필요한 데이터를 주고 받는데 자원 소비

## HTTP/2

* 멀티플렉싱 : 한 연결에 다중 요청/응답 가능 (순서 보장) -> HOL Blocking 문제 해결
* 헤더 압축(Huffman Encoding, HPACK) 으로 데이터 크기 절감 -> 무거운 Header 해결
* 전송 방식 : 바이너리 프레임 기반

* Server Push : 클라이언트가 요청하기 전에 리소스를 보내는 방식
    * 클라이언트가 리소스가 필요할지 알기도 전에 미리 리소스를 로드하여 대기 시간을 줄인다.
    * 요청 최소화

![](https://velog.velcdn.com/images/khhkmg0205/post/51475c0d-63a2-4b2c-96b5-f5a1a35b8475/image.png)

* 하지만 HTTP/1.1보다 성능이 향상 되었지만 TCP 기반이라 HOL blocking은 여전

## HTTP/3

* TCP 대신 UDP 기반 QUIC 프로토콜 사용
* 무조건 https 사용
* HOL blocking 문제 완전 해결 (스트림 별 독립 전송)
* 초기 핸드셰이크가 빠르고, 재연결이 빠름
* 더 빠른 연결, 더 나은 모바일 환경을 지원하지만 지원 브라우저/서버가 필요
    * 네이버는 HTTP3와 HTTP2를 혼용하여 컨텐츠를 서빙하며, 구글은 HTTP3로만 서빙

### QUIC 프로토콜

> Quick UDP Internet Connections의 약자로, 2013년에 구글에서 공개한 전송 계층 프로토콜

* 순방향 오류 수정 메커니즘 적용
    * 전송한 패킷이 손실되었다면 수신 측에서 에러를 검출하고 수정하는 방식

* TCP 헤더는 신뢰성을 보장하지만 지연을 줄이기 힘든 구조로, UDP를 통해 데이터 전송에 집중
    * Youtube의 라이브 스트리밍, 동영상 서비스

* 헤더 압축을 HPACK이 아닌 QPACK 사용

#### 장점

1. 첫 연결에서 필요한 정보와 함께 데이터를 전송, 연결 선공 시 캐싱하여 다음 연결 때 사용
2. Connection UUID라는 고유 식별자로 연결
3. TLS 기본 적용
4. IP Spoofing / Replay Attack을 방지
5. 독립 스트림을 이용하여 향상된 멀티플렉스 기능

## 정리

| 항목                        | HTTP/1.0       | HTTP/1.1           | HTTP/2           | HTTP/3            |
| ------------------------- | -------------- | ------------------ | ---------------- | ----------------- |
| **출시연도**                  | 1996           | 1999               | 2015             | 2022              |
| **기반 전송 방식**              | TCP            | TCP                | TCP              | **UDP + QUIC**    |
| **Persistent Connection** | ❌ (요청마다 연결 종료) | ✅ (Keep-Alive)     | ✅                | ✅                 |
| **헤더 압축**                 | ❌              | ❌                  | ✅ (HPACK)        | ✅ (QPACK)         |
| **멀티플렉싱**                 | ❌              | ❌                  | ✅ (한 연결에 다중 스트림) | ✅ (HOL 문제 해결)     |
| **속도**                    | 느림             | 개선                 | 빠름               | 매우 빠름             |
| **주요 특징**                 | 기본적인 요청/응답     | Keep-Alive, 파이프라이닝 | 바이너리, 다중 요청      | 지연 최소화, 연결 성능 최적화 |


# HTTPS

HTTP + TLS(SSL), 암호화된 HTTP로 보안성을 강화한 프로토콜

TLS를 사용해 전송 데이터 암호화, 무결성 보장, 인증 수행

클라이언트의 요청 후 서버와 TLS 핸드셰이크 후 HTTP 통신

장점 : 도청 / 위조 / 변조 방지
단점 : 인증서 발급/갱신 필요, 초기 핸드셰이크 지연 (하지만 HTTP/3에서 해결)

---
#### 참고하면 좋은 이미지

https://freecontent.manning.com/animation-http-1-1-vs-http-2-vs-http-2-with-push/?source=post_page-----565a7b184c---------------------------------------