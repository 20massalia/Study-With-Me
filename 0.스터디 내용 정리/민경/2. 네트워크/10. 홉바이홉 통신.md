# 홉바이홉(Hop-by-Hop) 통신
> 데이터가 목적지까지 한 라우터씩 단계적으로 전달되는 방식 <br>
홉(hop)은 하나의 라우터 또는 게이트웨이를 의미

## 라우터와 홉

* 라우터(Router) : 서로 다른 네트워크 간의 데이터 전달을 담당.
* 홉(Hop) : 한 장치에서 다음 장치(보통 라우터)로 데이터가 전달되는 한 단계
  즉, 하나의 홉 = 하나의 라우터를 지난 것

---

## 라우팅 테이블

* 각 라우터는 라우팅 테이블을 가지고 있어, 목적지 IP에 따라 다음 홉을 결정

### 테이블 항목
* 목적지 네트워크
* 서브넷 마스크 : IP 주소의 어느 부분이 네트워크이고 호스트 부분인지
* 넥스트 홉 : 다음에 보낼 라우터 주소
* 인터페이스 : 패킷을 내보낼 인터페이스, 해당 라우터가 사용하는 포트
* 메트릭 : 특정 경로를 이용하는 데 드는 비용. 값이 낮을수록 우선순위가 높음

```
목적지         서브넷 마스크     넥스트 홉     인터페이스  메트릭
192.168.2.0   255.255.255.0   192.168.2.1    eth3     10
```

---

## 게이트웨이

* 일반 사용자의 PC는 보통 직접 라우팅을 하지 않고, 기본 게이트웨이로 모든 외부 트래을 보냄.
* 게이터웨이는 첫 번째 라우터 역할을 하며, 이후 홉바이홉으로 전달

---

![](https://velog.velcdn.com/images/khhkmg0205/post/d3f2ade2-e166-4a76-8434-a5ecb82a2df6/image.png)

---

## 동적, 정적 라우팅

* 정적 라우팅 (Static Routing) : 관리자가 직접 라우팅 경로 설정
* 동적 라우팅 (Dynamic Routing) : 라우터가 스스로 경로를 학습 / 업데이트 하는 방식 (RIP, OSPF)

### RIP

> 거리 벡터 기반 라우팅 프로토콜. 홉 수로 경로 계산

라우터는 이웃 라우터들과 주기적으로 라우팅 테이블 전체를 교환

항상 **가장 적은 홉 수**를 선택하여, 라우터는 자신이 아는 거리 정보를 이웃에게 그대로 전파

```
라우터 A → 라우터 B (1홉)
        → 라우터 C (2홉: A → B → C)
```

* 30초마다 주기적으로 업데이트하며 단순적인 구조

### OSPF

> 링크 상태 기반 라우팅 프로토콜. 전체 네트워크 구조를 기반으로 경로 계산

라우터는 자신의 링크 상태 정보(연결된 이웃 정보와 비용)을 전체 네트워크에 브로드캐스트

각 라우터는 전체 맵을 구성하고, 다익스트라 알고리즘으로 최단 경로 계산 <br>
항상 **가장 적은 비용**을 선택하여, 변화가 있을 때만 정보를 갱신하여 더 효율적

