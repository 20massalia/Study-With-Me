# CPU의 작동 원리
컴퓨터의 CPU는 수많은 작업을 빠르게 처리하는 ‘두뇌’ 역할을 하지만 그 ‘두뇌’ 속에서 실제로 생각하고 계산하는 핵심 부품 3가지가 ALU, CU, 레지스터가 있다.

| 구성 요소 | 이름                    | 주요 역할         |
| ----- | --------------------- | ------------- |
| ALU   | Arithmetic Logic Unit | 계산 및 논리 연산    |
| CU    | Control Unit          | 명령 해석 및 실행 지시 |
| 레지스터  | Register              | 초고속 임시 기억 공간  |

## ALU
ALU(Arithmetic Logic Unit)는 산술과 논리 연산을 처리하는 유닛

- ALU의 주요 기능
    - 덧셈, 뺄셈, 곱셈, 나눗셈 등 산술 연산
    - AND, OR, NOT, XOR 같은 논리 연산
    - 두 값의 크기 비교 (예: A > B?)

ALU의 플래그 (x86 기준)

| 플래그 이름    | 약어 (Flag)                 | 의미                                       | 설정되는 조건                           |
| --------- | ------------------------- | ---------------------------------------- | --------------------------------- |
| 캐리 플래그    | CF (Carry Flag)           | 덧셈에서 자리올림(carry), 뺄셈에서 자리내림(borrow)을 나타냄 | 무부호 연산에서 결과가 레지스터 크기를 초과하거나 부족할 때 |
| 패리티 플래그   | PF (Parity Flag)          | 결과의 하위 8비트에 1의 개수가 짝수면 설정                | 주로 디버깅이나 하드웨어 통신에서 사용             |
| 보조 캐리 플래그 | AF (Auxiliary Carry Flag) | 하위 4비트(BCD 연산 등)에서 자리올림 발생               | BCD(Binary-Coded Decimal) 연산에 사용됨 |
| 제로 플래그    | ZF (Zero Flag)            | 연산 결과가 0일 때 설정                           | 조건 분기나 반복문에 활용                    |
| 부호 플래그    | SF (Sign Flag)            | 결과의 부호를 나타냄. 최상위 비트(MSB)가 1이면 설정 (음수)    | 2의 보수 기반 음/양 구분                   |
| 오버플로우 플래그 | OF (Overflow Flag)        | 부호 있는 정수 연산에서 오버플로우 발생 시 설정              | 덧셈 또는 뺄셈 결과가 표현 범위를 벗어날 때         |
| 인터럽트 플래그  | IF (Interrupt Flag)       | 외부 인터럽트 허용 여부                            | 시스템 동작 제어용                        |
| 방향 플래그    | DF (Direction Flag)       | 문자열 처리 시 증가/감소 방향 제어                     | `STD`, `CLD` 명령어로 제어              |


## CU
CU(Control Unit)는 CPU 내부에서 모든 작업 흐름을 관리

- CU의 주요 기능
    - 메모리(RAM)에서 명령어를 가져옴(Fetch)
    - 명령어를 해석(Decode)
    - ALU나 레지스터 등에게 무엇을 어떻게 하라고 지시(Execute)

## 레지스터
레지스터(Register)는 CPU 안에 있는 아주 빠른 임시 저장 공간

- 보통 수십 개 정도의 레지스터가 존재하고, 각각 1~64비트 정도 크기
- RAM보다 훨씬 작지만 훨씬 빠름
- 명령어, 연산 대상, 연산 결과 등을 잠깐 저장할 때 사용

## 세 요소가 일하는 과정

- 명령어 Fetch: CU가 RAM에서 명령어(예: A + B)를 읽어옴
- 명령어 Decode: CU가 명령 해석
- 레지스터 준비: CU가 레지스터에 A, B 값을 불러옴
- 연산 요청: ALU가 레지스터의 A, B를 계산
- 결과 저장: 결과를 다시 레지스터에 저장 → 필요시 RAM으로 이동
- 다음 명령 처리: CU는 다음 명령어를 위해 다시 Fetch 단계로 돌아감