# DNS (Domain Name System)
사람이 읽을 수 있는 도메인 주소를, 컴퓨터가 이해할 수 있는 IP 주소로 변환해주는 시스템

## 동작 구조
1. 사용자 브라우저 입력: `www.example.com`
2. 로컬 DNS 캐시 확인
3. 재귀 DNS 서버 요청 (ISP 또는 OS 설정)
4. 루트 네임서버 → TLD 서버 → 권한 네임서버 탐색
5. 최종 IP 주소 반환
6. 브라우저가 해당 IP로 HTTP 요청 전송

이 과정을 재귀 조회 + 반복 조회 방식으로 구현

## DNS 조회 방식
### 재귀 조회 (Recursive Query)
- 클라이언트(사용자)가 원하는 IP를 찾을 때 까지 찾으라는 요청을 DNS 서버에 요청
- 재귀 DNS 서버가 직접 모든 네임서버를 탐색하고 최종 IP를 찾아줌

###  반복 조회 (Iterative Query)
- DNS 서버가 다른 상위 서버 주소로 응답
- 클라이언트가 계속 다른 서버에게 직접 요청해서 IP를 찾아감

## 루트 네임서버(Root Name Server)
- DNS 탐색의 시작점, 최상위 노드
- TLD 서버의 위치(IP)를 알려주는 역할을 함 (ex. .com 도메인 정보를 알려줌)

## TLD 서버 (Top-Level Domain Server)
- .com, .net, .kr, .org 등의 최상위 도메인(TLD)에 대한 권한을 가진 서버
- TLD 서버는 해당 도메인 하위의 권한 네임서버 정보를 반환함 (ex. example.com 의 도메인 정보를 알려줌)

## 권한 네임서버 (Authoritative Name Server)
- 실제 도메인의 최종 IP 주소를 알고 있는 서버
- example.com에 대한 진짜 IP 정보가 저장되어 있음
- 클라이언트에게 정확한 A/AAAA 레코드 응답을 해줌

## 전체 흐름
```text
사용자 → 재귀 DNS 서버 → 루트 네임서버
                    ↓
               TLD 서버 (.com)
                    ↓
        권한 네임서버 (example.com)
                    ↓
         최종 IP 주소 응답
```

## DNS 레코드 종류
| 유형    | 설명         | 예시                          |
| ----- | ---------- | --------------------------- |
| A     | IPv4 주소 매핑 | `example.com → 192.0.2.1`   |
| AAAA  | IPv6 주소 매핑 | `example.com → 2001:db8::1` |
| CNAME | 별칭 주소      | `www → example.com`         |
| MX    | 메일 서버 지정   | `mail.example.com`          |
| NS    | 권한 네임서버 지정 | `ns1.example.com`           |
| TXT   | 텍스트 정보 저장  | SPF, 인증 정보 등                |

## DNS에서 사용하는 알고리즘
DNS는 단순히 IP 주소를 반환하는 것이 아니라, 부하 분산이나 지리적 위치 기반 응답을 위해 다양한 알고리즘을 사용

### 1. 라운드 로빈
- 여러 IP 주소를 등록해 두고 순차적으로 응답
- 예: `www.example.com`에 3개의 IP가 등록돼 있다면
  - 첫 번째 요청 → IP1
  - 두 번째 요청 → IP2
  - 세 번째 요청 → IP3
  - 네 번째 요청 → 다시 IP1
- 간단하지만 서버 부하 상황은 고려하지 않음

### 2. 지리 기반 라우딩 (GeoDNS) 
- 사용자의 지리적 위치를 기반으로 가장 가까운 서버의 IP를 응답
- 예: 
  - 한국 유저 → 서울 서버 IP
  - 미국 유저 → 캘리포니아 서버 IP
- 전 세계 사용자 대상 서비스에 유리 (예: CDN, 글로벌 서비스)

### 3. 가중치 기반 라우팅 (Weighted Round Robin)
- 각 서버에 가중치(weight)를 부여하여 비율 조정
- 예: 
    - 서버 A (60%), 서버 B (40%)로 트래픽 분산
    - 성능 좋은 서버에 더 많은 요청을 보낼 수 있음

### 4. 헬스 체크 기반 라우팅 (Health Check Failover)
- 서버의 상태를 체크해서, 정상인 서버만 응답에 포함
- 예: 
    - 서버 A가 다운되면, B만 응답하게 조정
    - 클라우드 DNS 서비스 (AWS Route 53, Cloudflare 등)에서 제공