# OSI 7계층

OSI 7계층은 ISO에서 정의한 네트워크 통신 참조 모델로 복잡한 통신 과정을 7단계로 나누어 설명하고 있다.

| 계층  | 이름                       | 주요 역할                      |
| --- | ------------------------ | -------------------------- |
| 7계층 | **응용 계층 (Application)**  | 사용자와 가장 가까운 계층, HTTP/FTP 등 |
| 6계층 | **표현 계층 (Presentation)** | 데이터 인코딩/암호화/압축             |
| 5계층 | **세션 계층 (Session)**      | 연결 유지 및 관리                 |
| 4계층 | **전송 계층 (Transport)**    | 신뢰성 있는 데이터 전송, TCP/UDP     |
| 3계층 | **네트워크 계층 (Network)**    | 경로 결정 및 IP 주소 기반 라우팅       |
| 2계층 | **데이터링크 계층 (Data Link)** | MAC 주소 기반 데이터 전달           |
| 1계층 | **물리 계층 (Physical)**     | 전기적 신호 전송 (케이블, 무선 등)      |

# TCP/IP 4계층

TCP/IP는 실제 인터넷에서 사용되는 통신 모델로, OSI 모델을 보다 단순화한 구조. 실질적인 구현 중심으로 인터넷 기반의 모든 네트워크가 이 구조를 따른다.

| 계층  | 이름                       | 주요 역할                         |
| --- | ------------------------ | ----------------------------- |
| 4계층 | **응용 계층 (Application)**  | HTTP, FTP, DNS, SMTP 등        |
| 3계층 | **전송 계층 (Transport)**    | TCP, UDP                      |
| 2계층 | **인터넷 계층 (Internet)**    | IP, ICMP                      |
| 1계층 | **네트워크 인터페이스 계층 (Link)** | Ethernet, Wi-Fi, MAC 주소 기반 전송 |

# OSI 7계층 vs TCP/IP 4계층
| OSI 7계층    | TCP/IP 4계층      | 설명                       |
| ---------- | --------------- | ------------------------ |
| 7 응용 계층    | 4 응용 계층         | 사용자 서비스 제공 (HTTP, FTP 등) |
| 6 표현 계층    | 〃               | 데이터 형식 변환 (인코딩/암호화 등)    |
| 5 세션 계층    | 〃               | 세션 연결 및 관리               |
| 4 전송 계층    | 3 전송 계층         | TCP/UDP를 통한 신뢰성 있는 전송    |
| 3 네트워크 계층  | 2 인터넷 계층        | IP 주소 기반 라우팅             |
| 2 데이터링크 계층 | 1 네트워크 인터페이스 계층 | MAC 주소 기반 통신             |
| 1 물리 계층    | 〃               | 실제 전기 신호 전송              |

# PDU (Protocol Data Unit)

PDU란 각 계층에서 데이터를 주고받을 떄 사용하는 데이터 단위다.

| 계층            | TCP/IP 계층         | PDU 명칭                                               |
| ------------- | ----------------- | ---------------------------------------------------- |
| 애플리케이션 계층     | Application       | **데이터 (Data)**                                       |
| 전송 계층         | Transport         | **세그먼트 (Segment)** (TCP), **데이터그램 (Datagram)** (UDP) |
| 인터넷 계층        | Internet          | **패킷 (Packet)**                                      |
| 네트워크 인터페이스 계층 | Network Interface | **프레임 (Frame)**                                      |

## 세그먼트(Segment)

- 사용 계층 : 전송 계층 (TCP)
- 사용 프로토콜 : TCP
- 특징 :
    - 연결지향형 : 신뢰성 있는 통신 제공
    - 순서 보장, 재전송, 오류 제어
    - TCP 헤더에는 포트 번호, 순서 번호, 확인 응답 번호(ACK) 등이 포함
- 사용자가 브라우저로 HTTP 요청을 보내면, 이 데이터는 전송 계층에서 세그먼트로 나뉘고 순서 정보가 부여됨

## 데이터그램(Datagram)

- 사용 계층 : 전송 계층 (UDP)
- 사용 프로토콜 : UDP
- 특징 :
    - 비연결형 : 빠르지만 신뢰성 없음
    - 순서 보장 없음, 손실 발생 가능
    - UDP 헤더에는 포트 번호, 길이, 체크섬만 포함
- 온라인 게임, 영상 스트리밍 등 실시간성이 중요한 곳에서 사용

## 패킷(Packet)

- 사용 계층 : 인터넷 계층
- 사용 프로토콜 : IP
- 특징 :
    - 상위 계층(TCP/UDP)의 세그먼트/데이터그램에 IP 헤더를 붙인 것
    - 목적지 IP 주소, 송신자 IP 주소 등을 포함
    - 라우팅 대상 : 라우터는 IP 패킷을 보고 어디로 보낼지 결정
- TCP 세그먼트 또는 UDP 데이터그램이 IP 주소를 포함하면서 패킷이 됨

## 계층별 캡슐화
네트워크에서 상위 계층에서 하위 계층으로 내려갈수록 데이터에는 헤더 정보가 점점 추가되는데 이걸 캡슐화 과정이라고 한다. 상위 계층의 데이터는 하위 계층의 payload(데이터 부분)로 포함되고 하위 계층은 자기 역할에 맞는 헤더를 덧붙여 더 큰 덩어리로 만들어 전송한다.

| 계층            | 명칭       | 데이터 구성                 | PDU                               |
| ------------- | -------- | ---------------------- | --------------------------------- |
| 응용 계층         | HTTP 등   | `데이터`                  | Data                              |
| 전송 계층         | TCP/UDP  | `TCP/UDP 헤더 + 데이터`     | 세그먼트 (Segment) / 데이터그램 (Datagram) |
| 인터넷 계층        | IP       | `IP 헤더 + TCP/UDP 세그먼트` | 패킷 (Packet)                       |
| 네트워크 인터페이스 계층 | Ethernet | `MAC 헤더 + IP 패킷 + FCS` | 프레임 (Frame)                       |
| 물리 계층         | 전기 신호    | `비트 단위로 인코딩`           | 비트 (Bit)                          |

> FCS : 프레임의 오류 검출을 위한 체크섬 역할을 하는 필드로 데이터 링크 계층에서 사용. 프레임의 맨 마지막에 추가되며, 수신자가 데이터 전송 중 손상됐는지 검사할 수 있게 해줌.

반대로 하위 계층에서 상위 계층으로 올라갈수록 역캡슐화를 통해 헤더를 제거하고 원본 데이터를 복원한다.  