# 프로세스의 메모리 구조
프로그램이 실행되어 프로세스가 되면, 운영체제는 해당 프로세스에게 고유한 메모리 공간을 할당한다. 이 메모리 공간은 용도에 따라 크게 네 가지 영역으로 나눌 수 있다.

## 1. 코드 영역(Code Segment)
- 정의: 실행할 프로그램의 명령어(기계어 코드)가 저장되는 영역
- 특징:
    - 읽기 전용(Read-Only) → 실행 중 코드가 변하지 않도록 보호
    - 여러 프로세스가 같은 프로그램을 실행하면, 이 영역은 공유 가능
- 예시: main() 함수의 기계어 코드, if/for 같은 제어문 변환 결과

## 2. 데이터 영역(Data Segment)
데이터 영역은 다시 두 부분으로 나뉜다.

- 초기화된 데이터 영역(Initialized Data Segment)
    - 전역 변수, static 변수 중 초기값이 있는 것 저장
    - 프로그램 시작 시 한 번 로드되고, 실행 중 값 변경 가능
    - 예: int count = 5;
- 초기화되지 않은 데이터 영역(BSS Segment)
    - 전역 변수, static 변수 중 초기값이 없는 것 저장
    - 프로그램 실행 시 자동으로 0으로 초기화
    - 예: static int total;

## 3. 힙 영역(Heap)
- 정의: 실행 중에 동적으로 메모리를 할당하는 영역
- 특징:
    - 런타임에 크기가 결정됨
    - C에서는 malloc/free, C++에서는 new/delete, Java에서는 new로 관리
    - 프로그래머가 직접 관리해야 하며, 잘못된 해제나 누락 시 메모리 누수 발생 가능
- 예시: 동적 배열, 런타임에 크기가 변하는 자료구조(연결 리스트 등)

## 4. 스택 영역(Stack)
- 정의: 함수 호출 시 생성되는 지역 변수와 매개변수가 저장되는 영역
- 특징:
    - LIFO(Last In First Out) 구조
    - 함수 호출 시 스택 프레임 생성, 함수 종료 시 자동 반환
    - 크기가 제한되어 있어 무한 재귀 시 스택 오버플로우 발생
- 예시
```java
void func(int x) {
    int local = x + 1; // 지역 변수 → 스택에 저장
}
```

```text
┌───────────────────────────┐  높은 주소
│        스택(Stack)         │ ← 함수 호출 시 확장
├───────────────────────────┤
│          힙(Heap)          │ → 동적 할당 시 확장
├───────────────────────────┤
│   초기화 안 된 데이터(BSS)     │
│ 초기화된 데이터(Data)         │
├───────────────────────────┤
│       코드(Code)           │  프로그램 명령어
└───────────────────────────┘  낮은 주소
```
- 스택은 위에서 아래로 확장
    - 스택 영역 전체의 최대 크기는 프로세스가 시작될 때 운영체제가 정해줌
    - 함수 호출 시 -> 스택 프레임이 쌓이며 사용량 증가
    - 함수 종료 시 -> 스택 프레임이 사라져 사용량 감소
    - 전체 용량은 고정이지만 실제 사용 크기는 유동적
- 힙은 아래에서 위로 확장
- 둘이 중간에서 만나면 메모리 부족(Out of Memory) 발생 가능