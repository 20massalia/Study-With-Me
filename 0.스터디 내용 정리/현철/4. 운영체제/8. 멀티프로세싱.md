# 멀티프로세싱
현대 운영체제와 서버 프로그램은 하나의 CPU만 쓰지 않고, 여러 개의 프로세스를 동시에 실행한다. 이걸 가능하게 하는 핵심 개념이 `멀티프로세싱(Multiprocessing)`이며, 서로 다른 프로세스가 협력하려면 반드시 `IPC(Inter-Process Communication)`가 필요하다.

## 1. 멀티프로세싱(Multiprocessing)
멀티프로세싱은 하나의 시스템에서 두 개 이상의 프로세스를 동시에 실행하는 방식. CPU 코어가 여러 개라면, 물리적으로 서로 다른 코어에서 병렬 실행이 가능하고, 코어가 하나라도 운영체제가 컨텍스트 스위칭을 통해 동시에 실행되는 것처럼 보이게 할 수 있다.

- 장점
    - 성능 향상: 작업을 병렬로 처리하여 처리량 증가
    - 안정성: 한 프로세스가 실패해도 다른 프로세스에는 영향이 적음
    - 확장성: 여러 CPU/코어를 활용 가능
- 단점 
    - 메모리 사용량 증가: 각 프로세스가 독립된 메모리 공간을 가짐
    - 통신 비용 발생: 프로세스 간 협력 시 IPC 필요

## 2. IPC(Inter-Process Communication)
프로세스는 기본적으로 독립된 메모리 공간을 가지므로, 직접 변수를 공유할 수 없다. 그래서 프로세스끼리 협력하려면 운영체제가 제공하는 통신 메커니즘을 사용해야 하는데, 이것이 바로 IPC다.

IPC의 목적
- 데이터 교환: 프로세스 간 정보를 주고받기
- 동기화: 특정 순서나 조건에 맞춰 실행 제어
- 자원 공유: 같은 파일, 메모리, 장치 접근 조율

## 3. 주요 IPC 방식
1. 파이프(Pipe)
    - 설명: 파이프는 한 프로세스의 출력(쓰기)을 다른 프로세스의 입력(읽기)으로 연결하는 통신 채널
    - 특징
        - 기본적으로 단방향 통신 (읽기/쓰기 방향이 고정)
        - FIFO(First In First Out) 방식으로 데이터가 전달
        - 부모-자식 프로세스 간에 주로 사용하며, 익명파이프(anonymous pipe)가 대표적
        - 익명파이프는 프로세스가 친척 관계여야 사용 가능
        - 이름있는 파이프(named pipe, FIFO)는 관계없는 프로세스도 통신 가능

2. 메시지 큐(Message Queue)
    - 설명: 메시지 단위로 데이터를 주고받는 큐를 운영체제가 관리해주는 방식
    - 특징
        - 비동기 통신 가능(보낸 쪽과 받는 쪽이 동시에 실행 안 해도 됨)
        - 메시지마다 우선순위 지정 가능
        - 크기가 제한된 메시지 단위로 송수신
        - 큐에 메시지를 넣거나 뺄 때 운영체제 호출로 처리되어 안정적

3. 공유 메모리(Shared Memory)
    - 설명: 여러 프로세스가 같은 물리적 메모리 공간을 공유하여 데이터 교환
    - 특징
        - 가장 빠른 IPC 방식 (메시지 복사가 필요 없으므로)
        - 메모리 영역에 직접 접근하므로 대용량 데이터 처리에 효율적
        - 동기화가 필수 (예: 세마포어, 뮤텍스) — 동시에 접근 시 데이터 손상 방지
        - 구현 복잡도 높음

4. 소켓(Socket)
    - 설명: 네트워크 통신의 기본 단위로, 프로세스 간 데이터를 송수신하는 인터페이스
    - 특징
        - 로컬 프로세스 간 통신(UNIX 도메인 소켓)과 원격 프로세스 간 통신(네트워크 소켓) 모두 지원
        - TCP, UDP 등 다양한 프로토콜 사용 가능
        - 분산 시스템에서 필수적인 IPC 수단

5. 시그널(Signal)
    - 설명: 프로세스에 특정 이벤트를 알리는 간단한 통신 방식
    - 특징
        - 프로세스 중단, 재시작, 사용자 정의 이벤트 알림 가능
        - 데이터 전송이 아니라 상태 알림에 특화
        - 비동기적이며 즉시 처리돼야 하는 상황에 적합

### IPC 방식별 흐름도
```text
[파이프]
프로세스 A (쓰기) ──> 파이프 ──> 프로세스 B (읽기)

[메시지 큐]
프로세스 A ──> 메시지 큐 ──> 프로세스 B

[공유 메모리]
프로세스 A ──┐
            │ (공유 메모리 영역)
프로세스 B ──┘
* 동기화 기법(세마포어 등) 필요

[소켓]
프로세스 A ── TCP/UDP ──> 프로세스 B
(로컬 또는 네트워크)

[시그널]
프로세스 A ──> 시그널 이벤트 ──> 프로세스 B
(알림 목적)

```

## 4. 멀티스레딩 vs 멀티프로세싱 + IPC
| 구분       | 멀티스레딩                 | 멀티프로세싱 + IPC               |
| -------- | --------------------- | -------------------------- |
| 메모리 공간   | 동일한 프로세스 내에서 메모리 공유   | 독립된 메모리 공간 (프로세스별 분리)      |
| 통신 방법    | 직접 변수 접근 가능           | 운영체제 제공 IPC 메커니즘 통해야 함     |
| 동기화 필요성  | 동기화 필수 (뮤텍스, 세마포어 등)  | IPC 수단별로 동기화 방법 다름         |
| 안정성      | 한 스레드 문제 시 전체 프로세스 영향 | 한 프로세스 문제 시 다른 프로세스 영향 적음  |
| 생성/관리 비용 | 낮음 (가벼움)              | 상대적으로 높음                   |
| 사용 사례    | 계산 집중 작업, UI 응답성 등    | 독립된 작업 병렬 처리, 보안 분리, 자원 공유 |




