# Redis

## Redis란?

Redis는 오픈 소스 인메모리(Key-Value) 데이터 저장소입니다.

DB, 캐시, 메시지 브로커 역할을 모두 수행하며 초저지연이 강점입니다.

디스크 대신 메모리에서 읽고 쓰기 때문에 조회/저장이 빠르고, 실시간성 요구(로그인 세션, 캐시, 알림, 순위 집계 등)에 널리 쓰입니다.

클라우드에선 Amazon ElastiCache for Redis 같은 관리형 서비스로 손쉽게 운영할 수 있습니다.

<br>

## 핵심 개념

- **데이터 구조**
  문자열(String), 리스트(List), 해시(Hash), 집합(Set), 정렬된 집합(Sorted Set) 등 **다양한 컬렉션을 기본 제공**합니다.
  실시간 피드, 랭킹(리더보드), 카운터 등을 간단히 모델링할 수 있습니다.
- **영속성 옵션**
  인메모리이지만 옵션으로 데이터를 디스크에 남길 수 있습니다.
  - **RDB 스냅샷**: 특정 시점에 메모리 전체를 덤프.
  - **AOF**: 모든 쓰기 명령을 로그에 **순차 기록** 후 재시작 시 재생.
  필요에 따라 성능·내구성 균형을 조절합니다.
- **실시간 메시징**
  **Pub/Sub**(채널 기반 브로드캐스트)와 **Streams**(소비자 그룹 기반 로그)로 알림/채팅/이벤트 스트리밍을 구현합니다.
- **성능 모델**
  인메모리 + **이벤트 루프 기반(단일 스레드 중심) I/O 멀티플렉싱**으로 잠금 경쟁을 피하고 지연을 줄입니다.
  최근 버전은 I/O 보조 스레드를 도입했지만, 핵심 처리 흐름은 단일 이벤트 루프 설계 철학을 유지합니다.

<br>

## Redis를 활용하면 좋은 대표적인 프로젝트

### 세션 관리

Redis는 사용자 세션 데이터를 메모리에 저장하여 빠르고 효율적인 세션 관리를 지원합니다.

- 사용자 인증 속도 향상
  로그인 시 사용자 데이터를 즉각적으로 조회할 수 있어 인증 속도를 크게 높입니다.
- 세션 만료 관리
  TTL을 설정해 불필요한 데이터가 메모리를 차지하지 않도록 자동으로 만료시킵니다.
  이를 통해 메모리 사용을 효율적으로 관리할 수 있습니다.
- 다중 서버 환경 지원
  Redis를 중앙 세션 저장소로 사용하면 여러 웹 서버 간 세션 데이터를 쉽게 공유할 수 있어 로드밸런싱 환경에서도 안정적인 세션 관리가 가능합니다.

### 캐싱 시스템

Redis는 자주 조회되는 데이터를 메모리에 캐싱하여 데이터베이스의 부하를 줄이고 빠른 응답 속도를 제공합니다.

- 읽기 부하 분산
  제품 정보, 페이지 콘텐츠 같은 고빈도 읽기 요청을 Redis에 캐싱해 데이터베이스의 읽기 부하를 감소시킵니다.
- 복잡한 연산 속도 향상
  상품 추천이나 검색 결과처럼 계산이 많은 데이터를 Redis에 저장해 클라이언트 요청 시 빠르게 반환할 수 있습니다.
- 만료 정책 지원
  캐싱 데이터에 TTL을 설정해 오래된 데이터를 자동으로 제거, 최신 상태를 유지할 수 있습니다.

### 실시간 분석

실시간 데이터 처리가 중요한 환경에서 빠른 데이터 조회와 집계 기능을 제공합니다.

- 대시보드 업데이트
  트래픽, 사용자 행동 데이터 같은 정보를 Redis에 저장해 실시간으로 대시보드에 반영할 수 있습니다.
- 실시간 통계 계산
  Redis의 Sorted Set이나 Hash 구조를 활용해 사용자 활동 집계나 순위 계산을 즉시 처리할 수 있습니다.
- 이벤트 처리
  실시간으로 발생하는 이벤트 데이터를 저장하고 처리해 이상 징후 탐지, 트랜잭션 모니터링 같은 시스템에 활용됩니다.

### 메시지 큐

Redis의 Pub/Sub 기능은 실시간 메시지 전송과 수신을 간단하고 효율적으로 처리합니다.

- 실시간 알림 시스템
  Redis를 활용하면 이메일 알림, 푸시 알림을 실시간으로 전송할 수 있습니다.
- 채팅 애플리케이션
  사용자 간 메시지를 Redis를 통해 즉시 전달해 끊김 없는 실시간 채팅 환경을 구현할 수 있습니다.
- 스트리밍 데이터 관리
  Redis Streams 기능을 사용하면 실시간으로 데이터 스트리밍을 관리하고, 여러 소비자에게 데이터를 분배할 수 있어 확장성이 뛰어납니다.

<br>

## Redis 활용 시 주의 사항

Redis는 데이터를 메모리에서 처리하기 때문에 매우 빠른 성능을 제공하지만, 메모리 사용량이 많아질 수 있다는 단점이 있습니다.

특히 대용량 데이터를 다룰 때는 메모리 비용이 크게 증가할 수 있으므로, 데이터를 효율적으로 관리하고 메모리 사용을 최적화하는 전략이 필요합니다.

### 메모리 최적화를 위한 방법

- TTL(Time To Live)을 설정하여 불필요한 데이터가 메모리를 차지하지 않도록 관리합니다.
  자동으로 데이터가 만료되도록 설정하면 메모리 사용을 줄일 수 있습니다.
- 자주 사용되지 않는 데이터를 적절히 삭제하거나, LRU(Least Recently Used) 알고리즘을 적용하여 메로리를 효율적으로 관리합니다.
- 압축 기능을 사용하여 데이터 저장 시 공간을 절약할 수 있습니다.

### 장애 복구 계획 수립

Redis는 마스터-슬레이브 복제와 클러스터링 기능을 통해 높은 가용성을 제공하지만, 장애 발생 시 데이터 유실의 가능성을 완전히 배제할 수는 없습니다.

예를 들어, 마스터 노드에 장애가 발생하면 슬레이브 노드로 자동 전환되지만, 전환 과정에서 일부 데이터가 유실될 수 있습니다.

이러한 위험을 최소화하려면 Redis를 사용할 때 철저한 장애 복구 계획을 수립하는 것이 중요합니다.

- **Redis Cluster**를 사용해 여러 노드에 데이터를 분산시켜, 특정 노드에 장애가 발생하더라도 다른 노드에서 데이터를 복구할 수 있도록 설정합니다.
- **AOF(Append Only File)**와 **스냅샷(Snapshot)** 기능을 사용하여 데이터를 정기적으로 디스크에 저장하고, 서버가 중단되었을 때 데이터를 복구할 수 있는 백업 전략을 수립합니다.

### 클러스터 환경에서의 데이터 일관성 문제

Redis는 성능과 확장성을 위해 클러스터 환경을 지원하지만, 클러스터 환경에서는 데이터 일관성 문제가 발생할 가능성이 있습니다.

특히 마스터-슬레이브 구조에서 노드 간 데이터 동기화가 지연될 경우 일관성에 영향을 줄 수 있습니다.

이러한 문제를 최소화하려면 데이터 복제와 동기화 설정을 최적화하고, 적절한 데이터 관리 전략을 수립하는 것이 중요합니다.

- **복제 지연(replication lag)**을 줄이기 위해 Redis 노드 간의 통신 속도를 높이고, 슬레이브 노드가 마스터 노드와 실시간으로 동기화되도록 설정합니다.
- **비동기 복제** 대신 **동기화 복제**(synchronous replication)를 사용할 수 있지만, 이는 성능에 영향을 줄 수 있으므로 트레이드오프를 잘 고려해야 합니다.

<br>
<br>

> 참고
>
> - https://www.elancer.co.kr/blog/detail/768
