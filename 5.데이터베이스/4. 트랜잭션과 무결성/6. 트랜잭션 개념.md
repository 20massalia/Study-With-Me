# 트랜잭션

## 트랜잭션의 정의

트랜잭션이란 데이터베이스에서 하나의 논리적인 작업 단위를 의미합니다. 여러 SQL 문장을 실행할 때에 하나의 묶으로 처리하기 위함입니다.

- All or Nothing: 모두 성공하거나, 하나라도 실패시 전체 취소

## 트랜잭션의 필요성

트랜잭션은 작업의 완전성을 보장해주는 것입니다.

논리적인 작업들을 모두 완벽하게 처리하거나 또는 처리하지 못할 경우 이전상태로 복구하며, 작업의 일부만 적용되는 현상이 발생하지 않도록 하는 기능입니다.

#### 예) 은행 계좌 이체

1. A 계좌에서 10만원 출금
2. B 계좌에 10만원 입금

업은 둘 다 성공하거나, 둘 다 실패해야 데이터 무결성이 유지됩니다.

## 트랜잭션의 특징

1. 트랜잭션은 데이터베이스 시스템에서 병행 제어 및 회복 작업 처리 시 처리되는 작업의 논리적 단위이다.
2. 사용자가 시스템에 대한 서비스 요구시 시스템이 응답하기 위한 상태 변환 과정의 작업단위이다.
3. 하나의 트랜잭션은 Commit 되거나 Rollback 된다.

## 트랜잭션의 연산 및 상태

### Commit
Commit 연산은 한 개의 논리적 단위(트랜잭션)에 대한 작업이 성공적으로 끝났고 데이터베이스가 일관된 상태에 있을 때, 이 트랜잭션이 행한 갱신 연산이 완료된 것을 트랜잭션 관리자에게 알려주는 연산입니다.

### Rollback
하나의 트랜잭션 처리가 비정상적으로 종료되어 데이터베이스의 일관성을 깨뜨렸을 때, 이 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 원자성을 구현하기 위해 이 트랜잭션이 행한 모든 연산을 취소합니다.

## 트랜잭션의 상태

![트랜잭션 사이클](https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTG_J8jQROtBH9TugqPYHbIvAG3PjZbDHvAVw&s)

- 활동: 트랜잭션이 실행 중인 상태
- 실패: 트랜잭션 실행에 오류가 발생해 중단된 상태
- 철회: 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태
- 부분완료: 트랜잭션의 마지막 연산까지 실행한 후에, Commit 연산이 실행되기 직전 상태
- 완료: 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태

## Reference

https://dev-coco.tistory.com/72