# OSI 7계층

OSI 7계층 (Open System Interconnection 7 Layer Model)은 네트워크 통신 과정을 7개의 계층으로 나누어 각 계층이 특정 역할을 담당하도록 한 국제 표준 모델입니다.
각 계층은 하위 계층의 기능을 기반으로 상위 계층에 서비스를 제공하며, 네트워크 설계와 문제 해결, 프로토콜 개발에 중요한 기준이 됩니다.

## OSI 7 계층 구조 및 역할

![OSI_7Layer_IMG](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F995EFF355B74179035)

### 1. **물리 계층**
- 실제 전기적/물리적 신호로 데이터 전송, 케이블-장비 등 물리적 연결 
- 케이블, 리피터, 허브
- 비트(Bit Stream)
- 비트 신호로 변환, 별도 헤더 없음

### 2. **데이터 링크 계층**
- 물리적 주소(MAC) 사용, 프레임 단위 전송, 오류 검출/수정, 흐름 제어 
- Ethernet, 스위치
- 프레임(Ethernet Frame)
- Ethernet 헤더 (MAC 주소, EtherType 등), 트레일러(FCS 등)

### 3. **네트워크 계층**
- 논리적 주소(IP) 사용, 데이터의 경로 설정, 패킷 전달 
- IP, ICMP, ARP, 라우터
- 패킷(IP Packet)
- IP 헤더 (출발지/목적지 IP, TTL, 프로토콜 등)

IP 주소는 인터넷 또는 네트워크에 연결된 각 장치를 고유하게 식별하는 주소입니다.

#### 주요 기능

- 호스트 식별: 네트워크 상의 장비를 구분하는 고유한 주소 역할
- 위치 지정: 데이터를 어디로 전송해야 하는지 목적지의 위치를 지정
- 라우팅: IP 주소를 기반으로 네트워크 내에서 최적의 경로를 찾아 패킷을 전달

#### IPv4 주소 고갈 문제

IPv4는 32비트 주소 체계로 한계가 있습니다. 이러한 문제를 해결하기 위해 IPv6를 도입했지만, 아직도 많은 기기가 IPv4를 사용하고 있습니다.

- NAT(Network Address Translation): 여러 내부 장치에 사설 IP를 부여하고, 외부 통신시 공인 IP로 변경
- 서브넷팅: 큰 네트워크를 작은 네트워크로 분할
- IPv6 도입: 128비트의 주소 체계로 사실상 무한대의 주소를 제공합니다.

#### DHCP (Dynamic Host Configuration Protocol)

네트워크에 새로운 기기가 연결되었을 때에 기본적으로 IP를 자동 할당해주는 프로토콜입니다.

- 자동 IP 주소 할당: 네트워크 내의 클라이언트들에게 IP 주소를 자동으로 할당합니다.
- 네트워크 설정 정보 제공 (서브넷 마스크, 게이트웨어, DNS 주소, 등)
- 중복 IP 주소 방지: 이미 할당된 IP 주소를 다른 장치에 할당하지 않도록 관리합니다.
- 임대 시간 관리: IP 주소를 일정 기간 동안 임대해 주고, 만료되면 회수하여 다른 장치에 할당할 수 있도록 합니다.

다른 기능으로는 고정 IP 할당 기능이 있습니다.

### 4. **전송 계층**
- 신뢰성 있는 데이터 전송, 오류 검출.복구, 포트 관리, 패킷 분할/재조립 
- TCP, UDP
- 데이터 그램, 세그먼트 (TCP Segment, UDP Datagram)
- TCP/UDP 헤더 (포트 번호, 시퀀스 번호 등)

### 5. **세션 계층**
- 통신 세션(연결) 관리, 세션 설정 관리, 동기화 
- RPC, 세션
- 메세지(Message)
- 별도의 헤더 없음 (일반적으로 데이터 자체)

### 6. **표현 계층**
-  데이터 형식 변환, 암호화/복호화, 압축 데이터 표현 방식 관리 
- JPEG, SSL, TLS
- 메세지(Message)

### 7. **응용 계층**
- 사용자와 직접 상호작용하는 소프트웨어 지원, 네트워크 서비스 제공 
- HTTP, FTP, SMTP, DNS
- 메세지(Message)

## OSI 7 계층의 의의

- 표준화: 다양한 하드웨아, 소프트웨어 간 호환성 보장
- 문제 해결: 네트워크 문제 발생 시 원인 계층을 빠르게 진단 가능
- 확장성/유연성: 각 계층 독립적 설계로 새로운 기술 도입이 용이

## TCP/IP 모델과 OSI 모델의 차이점

OSI 모델은 과거 1970~1980년대 초반, 각기 다른 제조사에 따른 네트워크 장비와 시스템이 호환되지 않아 통신이 어려운 상황에서 등장했습니다.
위와 같은 의의 3가지를 충족시키기 위해 만들어졌습니다.

하지만, 현대에 들어서며 TCP/IP 모델이 인터넷 구현을 위한 실질적 모델로 실제 사용되는 프로토콜(TCP, IP)에 기반해 설계 되었습니다.

즉, 목적 및 성격이 다릅니다. OSI 모델은 이론적, 표준화, 프로토콜 독립적을 중점으로 보며, TCP/IP 모델은 실제 구현, 인터넷 중심, 프로토콜 중심으로 설계되었습니다.

## 부가질문

### Transport Layer와, Network Layer의 차이는?

Transport 계층(4계층)은 TCP/UDP 등 프로세스(포트) 간 신뢰성 있는 데이터 전송 역할을 가집니다.
Network 계층(3계층)은 호스트(네트워크) 간 데이터 전달, 라우팅에 역할을 가집니다.
즉, 주소 방식이 포트 번호, IP 주소에 따라 구분할 수 있습니다.

### IP가 송신자와 수신자를 정확하게 전송해 주는가?

아닙니다. IP는 전송을 보장하지 않습니다.

- 비연결성, 비신뢰성: IP는 데이터 전송만 담당하며, 패킷손실, 순서 변경, 중복, 지연 등에 대해서 보장하지 않습니다.
- 신뢰성 보장: TCP와 같은 상위 계층 프로토콜이 이러한 부분의 단점을 보안합니다.

### 내부 서브넷의 컴퓨터가 라우터를 통해 Request를 보내고 나서 Response를 어떻게 받을까?

사설 IP 주소를 가지는 PC가 인터넷에 요청을 보내고 응답을 받을 때에 어떻게 내부 PC로 패킷이 올 수 있을까요?

바로 NAT와 포트 번호 매핑을 통해 응답을 받습니다.

- NAT 동작 방식
  1. 내부 PC -> 외부로 요청
  2. 라우터(NAT)가 변환
     - 내부 출발지 IP를 공인 IP 변경하고 송신포트를 기록 해둡니다. (NAT 세션 테이블)
  3. 외부 서버에서 응답
  4. 라우터가 내부로 라우팅
     - 라우터가 NAT 테이블을 참조하여 해당 송신포트로 온 패킷이 어떤 컴퓨터와 연결된 세션인지 확인 후에 내부 컴퓨터로 전달합니다.

## Reference

https://shlee0882.tistory.com/110
https://github.com/VSFe/Tech-Interview/blob/main/03-NETWORK.md
https://www.vsolcn.com/blog/layer-3-switch-routing-connection.html
https://www.cloudflare.com/ko-kr/learning/ddos/glossary/user-datagram-protocol-udp/